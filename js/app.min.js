function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:22.307159,lng:73.181219},zoom:13}),ko.applyBindings(new ViewModel)}function populateInfoWindow(e,t){if(t.marker!=e){t.setContent(""),t.marker=e,t.addListener("closeclick",function(){t.marker=null});var o=new google.maps.StreetViewService,a=50,i=function(t,o){if(o==google.maps.StreetViewStatus.OK){var a=t.location.latLng,i=google.maps.geometry.spherical.computeHeading(a,e.position),n={position:a,pov:{heading:i,pitch:30}};new google.maps.StreetViewPanorama(document.getElementById("streetview"),n)}else alert("No StreetView Found")},n="https://en.wikipedia.org/w/api.php?action=opensearch&search="+e.title+"&format=json&callback=wikiCallback",l=setTimeout(function(){alert("Failed to load wikipedia resources \n Please try later !!")},8e3);$.ajax({url:n,dataType:"jsonp",success:function(n){var r=n[3];o.getPanoramaByLocation(e.position,a,i),t.setContent('<div class= "infoWindow_title">'+e.title+'</div><div id= "url-div"></div><a class="place-url" href ="'+r+'">'+r+'</a><div id="streetview"></div>'),t.open(map,e),console.log(r),clearTimeout(l),0===r.length&&t.setContent('<div class= "infoWindow_title">'+e.title+'</div><div id= "url-div">No wikipedia resource found</div><div id="streetview"></div>')}})}}function toggleBounce(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(google.maps.Animation["null"])},1e3)}function makeMarkerIcon(e){var t=new google.maps.MarkerImage("https://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return t}jQuery(function(e){e(".content-list-btn").click(function(){e(".content-list").toggleClass("expand")})});var locations=[{title:"EME Temple",location:{lat:22.331528,lng:73.192078}},{title:"Tapovan Mandir",location:{lat:22.349476,lng:73.140855}},{title:"Baroda Museum & Picture Gallery",location:{lat:22.311999,lng:73.18866}},{title:"Mandvi Gate",location:{lat:22.300145,lng:73.210736}},{title:"Sayaji Baug",location:{lat:22.314007,lng:73.188194}},{title:"Laxmi Vilas Palace",location:{lat:22.293597,lng:73.191945}},{title:"Maharaja Fatehsinh Museum",location:{lat:22.289644,lng:73.191393}},{title:"Sardar Patel Planetarium",location:{lat:22.309353,lng:73.189406}},{title:"Crocodile Pond Sayaji Garden",location:{lat:22.311808,lng:73.191127}},{title:"Sur Sagar Lake",location:{lat:22.301039,lng:73.203916}}],map,markers=[],ViewModel=function(){function e(){populateInfoWindow(this,i),toggleBounce(this,m)}function t(){this.setIcon(l)}function o(){this.setIcon(n)}var a=this;a.locationList=ko.observableArray(locations),a.title=ko.observable(""),a.navigation=ko.observable(),a.currentMarker=function(e){toggleBounce(e.marker),google.maps.event.trigger(e.marker,"click")},a.query=ko.observable(""),a.search=ko.computed(function(){var e=a.query().toLowerCase();return ko.utils.arrayFilter(a.locationList(),function(t){var o=t.title.toLowerCase(),a=o.indexOf(e)>=0;return t.marker&&t.marker.setVisible(a),a})});for(var i=new google.maps.InfoWindow,n=makeMarkerIcon("FF0000"),l=makeMarkerIcon("0000FF"),r=new google.maps.LatLngBounds,s=0;s<locations.length;s++){var c=locations[s].location,g=locations[s].title,m=new google.maps.Marker({map:map,position:c,title:g,animation:google.maps.Animation.DROP,icon:n,id:s});markers.push(m),a.locationList()[s].marker=m,m.addListener("click",e),m.addListener("mouseover",t),m.addListener("mouseout",o),r.extend(markers[s].position)}map.fitBounds(r)},mapError=function(){alert("Fail to load google map. Try again later")};